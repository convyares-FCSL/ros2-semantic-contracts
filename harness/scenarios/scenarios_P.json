{
    "version": "0.1",
    "group": "P",
    "description": "Skeleton scenarios generated from traceability.md (grouped, keyed by scenario id).",
    "scenarios": {
        "P01_no_fabricated_params": {
            "spec_id": "P01",
            "title": "No fabricated parameters",
            "layer": "Core",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Core)."
        },
        "P02_dynamic_typing_rules": {
            "spec_id": "P02",
            "title": "Dynamic typing rules",
            "layer": "Core",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Core)."
        },
        "P03_redeclaration_fails": {
            "spec_id": "P03",
            "title": "Redeclaration fails",
            "layer": "Core",
            "requires": [
                "ros.params.declare"
            ],
            "notes": "Declaring the same parameter twice must fail deterministically.",
            "ops": [
                {
                    "op": "declare_param",
                    "payload": {
                        "name": "test_redeclare_param"
                    }
                },
                {
                    "op": "declare_param",
                    "payload": {
                        "name": "test_redeclare_param"
                    }
                }
            ],
            "expects": [
                {
                    "check": "custom",
                    "params": {
                        "must_observe": [
                            {
                                "type": "param_declare_request",
                                "name": "test_redeclare_param"
                            },
                            {
                                "type": "param_declare_response",
                                "name": "test_redeclare_param",
                                "successful": true
                            },
                            {
                                "type": "param_declare_request",
                                "name": "test_redeclare_param"
                            },
                            {
                                "type": "param_declare_response",
                                "name": "test_redeclare_param",
                                "successful": false
                            }
                        ]
                    }
                }
            ]
        },
        "P04_no_partial_application": {
            "spec_id": "P04",
            "title": "No partial application",
            "layer": "Core",
            "requires": [
                "ros.params.set_batch",
                "ros.params.declare"
            ],
            "notes": "Batch parameter updates with one invalid must reject entirely (atomic).",
            "ops": [
                {
                    "op": "declare_param",
                    "payload": {
                        "name": "valid_param"
                    }
                },
                {
                    "op": "set_params_batch",
                    "payload": {
                        "params": [
                            {
                                "name": "valid_param",
                                "value": "foo",
                                "type": "string"
                            },
                            {
                                "name": "undeclared_param",
                                "value": "bar",
                                "type": "string"
                            }
                        ]
                    }
                }
            ],
            "expects": [
                {
                    "check": "custom",
                    "params": {
                        "must_observe": [
                            {
                                "type": "param_declare_response",
                                "name": "valid_param",
                                "successful": true
                            },
                            {
                                "type": "param_set_batch_response",
                                "all_successful": false
                            }
                        ]
                    }
                }
            ]
        },
        "P05_readonly_enforcement": {
            "spec_id": "P05",
            "title": "Read-only enforcement",
            "layer": "Core",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Core)."
        },
        "P06_unknown_params_rejected": {
            "spec_id": "P06",
            "title": "Unknown params rejected",
            "layer": "Core",
            "requires": [
                "ros.params.set"
            ],
            "notes": "Setting an undeclared parameter must be rejected by the node.",
            "ops": [
                {
                    "op": "set_param",
                    "payload": {
                        "name": "param_does_not_exist",
                        "type": "integer",
                        "value": 42
                    }
                }
            ],
            "expects": [
                {
                    "check": "custom",
                    "params": {
                        "must_observe": [
                            {
                                "type": "param_set_request",
                                "name": "param_does_not_exist"
                            },
                            {
                                "type": "param_set_response",
                                "name": "param_does_not_exist",
                                "successful": false
                            }
                        ]
                    }
                }
            ]
        },
        "P07_change_record_ordering": {
            "spec_id": "P07",
            "title": "Change record ordering",
            "layer": "Core",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Core)."
        },
        "P08_unknown_types_not_set": {
            "spec_id": "P08",
            "title": "Unknown types NOT_SET",
            "layer": "Core",
            "requires": [
                "ros.params.describe"
            ],
            "notes": "Describing an unknown parameter must return type=NOT_SET (uninitialized). This validates ROS 2's parameter type system.",
            "ops": [
                {
                    "op": "describe_param",
                    "payload": {
                        "name": "param_that_does_not_exist_xyz"
                    }
                }
            ],
            "expects": [
                {
                    "check": "custom",
                    "params": {
                        "must_observe": [
                            {
                                "type": "param_describe_request",
                                "name": "param_that_does_not_exist_xyz"
                            },
                            {
                                "type": "param_describe_response",
                                "name": "param_that_does_not_exist_xyz",
                                "param_type": "NOT_SET"
                            }
                        ]
                    }
                }
            ]
        },
        "P09_atomic_updates": {
            "spec_id": "P09",
            "title": "Atomic updates (external)",
            "layer": "Core",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Core)."
        },
        "P10_rejected_updates_silent": {
            "spec_id": "P10",
            "title": "Rejected updates silent",
            "layer": "Core",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Core)."
        },
        "P11_events_describe_changes": {
            "spec_id": "P11",
            "title": "Events describe changes",
            "layer": "Core",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Core)."
        },
        "P12_describe_unknown_consistent": {
            "spec_id": "P12",
            "title": "Describe unknown consistent",
            "layer": "Core",
            "requires": [
                "ros.params.describe"
            ],
            "notes": "Describing an unknown parameter should produce a consistent observable response for the same input across repeated calls.",
            "ops": [
                {
                    "op": "describe_param",
                    "payload": {
                        "name": "param_does_not_exist"
                    }
                },
                {
                    "op": "describe_param",
                    "payload": {
                        "name": "param_does_not_exist"
                    }
                }
            ],
            "expects": [
                {
                    "check": "custom",
                    "params": {
                        "must_observe": [
                            {
                                "type": "param_describe_request",
                                "name": "param_does_not_exist"
                            },
                            {
                                "type": "param_describe_response",
                                "name": "param_does_not_exist",
                                "detail": {}
                            }
                        ]
                    }
                },
                {
                    "check": "describe_unknown_consistent",
                    "params": {
                        "name": "param_does_not_exist",
                        "min_calls": 2,
                        "evidence_ptr": "/detail"
                    }
                }
            ]
        },
        "P13_list_complete_stable": {
            "spec_id": "P13",
            "title": "List complete and stable",
            "layer": "Tooling",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Tooling)."
        },
        "P14_deletion_reported_events": {
            "spec_id": "P14",
            "title": "Deletion reported via events",
            "layer": "Policy",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Policy)."
        },
        "P15_parameter_interface_conformity": {
            "spec_id": "P15",
            "title": "Parameter Interface Conformity",
            "layer": "Global",
            "requires": [
                "graph.observe"
            ],
            "ops": [],
            "expects": [],
            "notes": "Interface introspection scenario. Validate parameter services exist."
        },
        "P16_explicit_declaration_mode": {
            "spec_id": "P16",
            "title": "Explicit Declaration Mode",
            "layer": "Global",
            "ops": [],
            "expects": [],
            "notes": "Populate ops/observations to validate this clause (Layer=Global)."
        }
    }
}